Discount service on Ruby on Rails